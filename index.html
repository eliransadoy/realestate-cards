<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8" />
<title>נכסים מעודכנים דינמי</title>
<style>
  body { font-family: Arial, sans-serif; direction: rtl; }
  .card { border: 1px solid #ccc; border-radius: 10px; padding: 15px; margin: 10px; max-width: 320px; }
  .card img { width: 100%; height: 200px; object-fit: cover; border-radius: 8px; }
  .card-title { font-weight: bold; margin: 10px 0; }
  .card-price { color: blue; font-weight: bold; margin: 10px 0; }
</style>
</head>
<body>
<h1>נכסים מעודכנים דינמי</h1>
<div id="container"></div>

<script>
const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTwZPTp77QNaC440BW-kIPolCcuXixC-kAU_Tqwy34qWeMYn3fOJSoOjtIqXrjs1OPyeTR0pGGrdMQD/gviz/tq?tqx=out:json&sheet=Sheet1';

fetch(url)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.substring(47).slice(0, -2));
    const rows = json.table.rows;
    const container = document.getElementById('container');

    rows.forEach((row, index) => {
      if (index === 0) return; // לדלג על שורת הכותרת
      const c = row.c;

      const name = c[3]?.v || 'אין שם';
      const description = c[1]?.v || '';
      const imageUrl = c[2]?.v || '';
      const price = c[7]?.v || 'מחיר לא זמין';
      const link = c[4]?.v || '#';

      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <a href="${link}" target="_blank"><img src="${imageUrl}" alt="תמונה"></a>
        <div class="card-title">${name}</div>
        <div>${description}</div>
        <div class="card-price">מחיר: ${price} ₪</div>
        <a href="${link}" target="_blank">קישור לנכס</a>
      `;

      container.appendChild(card);
    });
  })
  .catch(e => console.error('Error:', e));
</script>
</body>
</html>
